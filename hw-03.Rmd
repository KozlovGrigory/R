---
title: "Домашнее задание 03 - Дорожные происшествия"
author: "Григорий Козлов"
date: "4.12.21"
output: 
  md_document:
    variant: markdown_github
---

В этом задании мы рассмотрим дорожные происшествия в Эдинбурге.
Данные сделаны доступными [online](https://data.gov.uk/dataset/cb7ae6f0-4be6-4935-9277-47e5ce24a11f/road-safety-data/datafile/36f1658e-b709-47e7-9f56-cca7aefeb8fe/preview) Правительством Великобритании.
Данные покрывают все дорожные происшествия в Эдинбурге за 2018 год, некоторые переменные были модифицированы для настоящего задания.

## Данные

Данные содержатся в пакете **dsbox** в объекте `accidents`.
Для доступа к этим данным достаточно загрузить пакет.
Узнать больше о структуре набора данных можно, обратившись к документации, для чего в консоли нужно набрать `?accidents`.
Эту информацию также можно найти [здесь](https://rstudio-education.github.io/dsbox/reference/accidents.html).


## Загрузка пакетов и данных

```{r load-packages, message = FALSE}
library(tidyverse)
load('C:/Users/User/Desktop/R/accidents.rda')
```
Пакет "dsbox" не получилось установить, поэтому работал с отдельным файлом "accidents".

## Упражнения

### Упражнение 1

Сколько наблюдений (строк) содержится в наборе данных? Для ответа используйте код-в-строке (inline code).

```{r count, message = FALSE}
nrow(`accidents`)
```
В наборе данных содержится 768 наблюдений.


### Упражнение 2

Выполните выражение `View(accidents)` в консоли для просмотра данных на панели источников. Что представляет собой каждая строка в наборе данных?

```{r view, message = FALSE}
View(accidents)
```

Каждая строка представляет собой зарегистрированный случай дорожного происшествия в Эдинбурге за 2018 год.

### Упражнение 3

Воссоздайте следующий график, опишите его в контексте данных. 

![](accidents-task.png)

Не забудьте переименовать фрагмент кода (там, где сейчас указано `label-me-1`). Имя должно быть коротким, информативным и не должно содержать пробелов, а также не должно повторять имя предыдущего фрагмента.

```{r accidents_graphic_1}
days <- accidents$day_of_week == 'Saturday' | accidents$day_of_week == 'Sunday'
  accidents %>%
    mutate(day = 'Weekday')
  accidents %>%
    mutate(week = if_else(days, 'Weekend', 'Weekday'))%>%
  ggplot(aes(x = time, fill = severity)) + 
    geom_density(alpha = 0.5) +
    facet_wrap(~week, ncol = 1) +
    scale_fill_viridis_d() +
labs(
  title = 'Number of accidents throughout the day',
  subtitle = 'By day of week and severity',
  x = 'Time of day',
  y = 'Density',
  fill = 'Severity'
)
```

### Упражнение 4

Создайте другую визуализацию на основе данных и дайте интерпретацию. Вы можете использовать любые переменные любого типа, но их должно быть не меньше трех, то есть диаграммы рассеяния `x` vs. `y` недостаточно, но если точки будут раскрашены в соответствии с `z`, это нормально. Не забудьте переименовать фрагмент кода (там, где сейчас указано `label-me-2`).


```{r accidents_graphic_2}
ggplot(accidents, aes(x = day_of_week, y = time, 
                      colour = casualties, shape = severity)) +
  geom_point(alpha = 0.5) + theme(axis.text.x = element_text(angle=90, hjust=1))+ labs(
    x = "Время",
    y = "День недели",
    title = 'Зависимость времени происшествия, серьезности аварии и числа жертв от дня недели'
  )
```
Наибольшее число аварий происходит в период с 6 часов утра до 23 часов вечера, наименьшее число аварий наблюдается по воскресеньям. Суббота является днем с повышенным числом серьезных аварий, которые могут наблюдаться в течение всего дня, частота серьезных происшествий также возрастает в ночь на понедельник (вечер воскресенья, раннее утро понедельника). Эти же дни характеризуются повышенным числом жертв в ряде дорожных происшествий по сравнению с другими днями, что, вероятно, связано с тем, что в большинстве случаев эти дни являются выходными. Однако при этом большое количество серьезных и даже приведших к летальному исходу аварий с большим числом жертв было отмечено в среду, причем на протяжении всего дня. Наиболее безопасным для поездки днем можно считать пятницу.